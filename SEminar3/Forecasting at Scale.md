# Forecasting at Scale (대규모 예측, 2018)

<br>

## 순서
    1 소개, Introduction

    2 비즈니스 시계열의 특징, Features of Business Time Series

    3 Prophet 예측 모델, The Prophet Forecasting Model
        3.1  추세 모델, The Trend Model
            3.1.1 비선형, 포화성장, Nonlinear, Saturating Growth
            3.1.2 변화점이 있는 선형 추세, Linear Trend with Changepoints
            3.1.3 자동 변경점 선택, Automatic Changepoint Selection
            3.1.4 추세 예측 불확실성, Trend Forecast Uncertainty
        3.2 계절성, Seasonality
        3.3 휴일 및 이벤트, Holidays and Events
        3.4 모델 피팅, Model Fitting
        3.5 루프 내 분석 모델링, Analyst-in-the-Loop Modeling

    4 예측 평가 자동화, Automating Evaluation of Forecasts
        4.1 기본 예측의 활용, Use of Baseline Forecasts
        4.2 예측 정확도 모델링, Modeling Forecast Accuracy
        4.3 모의 과거 예측, Simulated Historical Forecasts
        4.4 대규모 예측 오류 파악, Identifying Large Forecast Errors

    5 결론, Conclusion


## Abstract

예측은 수용 계획, 목표 설정 및 이상 탐지를 지원하는 일반적인 데이터 과학 작업이다. 그 중요성에도 불구하고, 신뢰할 수 있고 고품질의 예측을 생성하는 것에는 심각한 문제가 있다. 특히 시계열이 다양하고 시계열 모델링에 전문 지식을 가진 분석가가 상대적으로 드문 경우에는 더욱 그렇다. 이러한 과제를 해결하기 위해, 우리는 구성 가능한 모델과 analyst-in-the-loop 성능 분석을 결합하는 "척도에 맞는" 예측에 대한 실용적인 접근 방식을 설명한다. 우리는 시계열에 대한 도메인 지식을 가진 분석가가 직관적으로 조정할 수 있는 해석 가능한 매개 변수를 가진 모듈식 회귀 모델을 제안한다. 우리는 예측 절차를 비교하고 평가하기 위해 성능 분석을 설명하고 수동 검토 및 조정을 위해 자동으로 예측에 플래그를 지정한다. 분석가가 자신의 전문 지식을 가장 효과적으로 사용할 수 있도록 지원하는 도구를 사용하면 비즈니스 시계열을 신뢰할 수 있고 실질적으로 예측할 수 있다.


## Introduction

예측은 조직 내 많은 활동의 중심이 되는 데이터 과학 작업이다. 예를 들어, 산업의 모든 부문에 걸쳐 조직은 부족한 자원을 효율적으로 할당하기 위해 용량 계획에 참여해야 하며, 목표 설정을 기준과 비교하여 성능을 측정해야 합니다. 고품질 예측을 작성하는 것은 기계나 대부분의 분석가에게 쉬운 문제가 아닙니다. 우리는 사업 예측을 작성하는 관행에서 두 가지 주요 주제를 관찰했다. 첫째, 완전 자동 예측 기법은 조정하기 어려울 수 있으며 유용한 가정이나 경험적 접근을 통합하기에는 너무 융통성이 없는 경우가 많다. 둘째, 조직 전체에서 데이터 과학 작업을 담당하는 분석가는 일반적으로 지원하는 특정 제품 또는 서비스에 대해 깊은 도메인 전문 지식을 가지고 있지만 종종 시계열 예측에 대한 교육을 받지 못한다. 따라서 예측은 상당한 경험을 필요로 하는 전문 기술이기 때문에 고품질 예측을 할 수 있는 분석가는 매우 드물다.

결과적으로 고품질 예측에 대한 수요는 종종 투입될 수 있는 속도를 훨씬 능가한다. 이러한 관찰은 우리가 여기서 제시하는 연구의 동기입니다. 우리는 규모에 따른 예측을 생성하기 위한 몇 가지 유용한 지침을 제공하고자 합니다.

우리가 다루는 첫 번째 두 가지 유형의 규머는 사업 예측 방법이 (1) 시계열 방법에 대한 교육을 받지 않은 많은 수의 사람들에게 적합해야 한다는 것과 (2) 잠재적으로 특이한 기능을 가진 다양한 예측 문제에 적합해야 한다는 것이다. 섹션 3에서는 광범위한 비즈니스 시계열에 충분히 유연하지고 데이터 생성 프로세스에 대한 도메인 지식은 있지만 시계열 모델 및 방법에 대한 지식은 거의 없는 비전문가가 구성할 수 있는 시계열 모델을 제시한다.

우리가 다루는 규모의 세 번째 유형은 가장 현실적인 설정에서 많은 수의 예측이 생성되어 이를 평가하고 비교하는 효율적이고 자동화된 수단이 필요하며 성능이 저하될 가능성이 있는 시기를 감지해야 한다는 것이다. 수백 또는 수천 개의 예측이 이루어질 때, 성능 문제를 해결하기 위해 인간의 피드백을 효율적으로 사용하면서 모델 평가와 비교라는 힘든 작업을 기계가 수행하도록 하는 것이 중요해진다. 섹션 4에서는 시뮬레이션된 과거 예측을 사용하여 샘플 외 성능을 추정하고 인간 분석가가 무엇이 잘못되었는지 이해하고 필요한 모델 조정을 할 수 있도록 문제가 있는 예측을 식별하는 예측 평가 시스템을 설명한다.

우리가 규모의 전형적인 고려사항인 계산과 저장에 초점을 맞추고 있지 않다는 것을 주목할 필요가 있다. 우리는 많은 시계열을 예측하는 계산 및 인프라 문제가 비교적 간단하다는 것을 발견했다. 일반적으로 이러한 적합 절차는 상당히 쉽게 병렬화되며 예측은 관계형 데이터베이스에 저장하기 어렵지 않다. 우리가 실제로 관찰한 규모의 실제 문제는 다양한 예측 문제와 일단 생성되면 많은 예측에서 신뢰를 구축함으로써 발생하는 복잡성을 포함한다.

대규모의 비즈니스 예측에 대한 루프 내 분석가 접근 방식을 그림 1에 요약한다. 우리는 각 매개 변수에 대한 간단한 인간 해석을 가진 유연한 사양을 사용하여 시계열을 모델링하는 것으로 시작한다. 그런 다음 다양한 역사적 시뮬레이션 예측 날짜에 걸쳐 이 모델에 대한 예측과 일련의 합리적인 기준선을 생성하고 예측 성능을 평가한다. 성능이 나쁘거나 예측의 다른 측면이 인간의 개입을 정당화할 때, 우리는 이러한 잠재적인 문제를 우선순위에 따라 인간 분석가에게 표시한다. 그런 다음 분석가는 예측을 검사하고 잠재적으로 이 피드백을 기반으로 모형을 조정할 수 있습니다.

analyst-in-the-loop : 예측의 시각적 검사 + 모델링
automated : 예측 평가 + 문제 드러내기

<br>

## 비즈니스 시계열의 특징, Features of Business Time Series

비즈니스 예측 문제는 매우 다양하지만 많은 공통적인 기능이 있다. 그림 2는 Facebook 이벤트의 대표적인 Facebook 시계열을 보여준다. Facebook 사용자는 이벤트 플랫폼을 사용하여 이벤트 페이지를 만들고, 다른 사용자를 초대하며, 다양한 방식으로 이벤트와 상호 작용할 수 있다. 그림 2는 Facebook에서 생성된 이벤트 수에 대한 일일 데이터를 보여준다. 이 시계열에는 주간 및 연간 주기, 크리스마스와 새해를 전후한 뚜렷한 하락 등 몇 가지 계절적 효과가 분명히 보인다. 이러한 유형의 계절 효과는 자연스럽게 발생하며 인간의 행동에 의해 생성된 시계열에서 기대할 수 있다. 시계열은 또한 지난 6개월 동안의 추세 변화가 뚜렷하며, 이는 신제품이나 시장 변화의 영향을 받는 시계열에서 발생할 수 있습니다. 마지막으로, 실제 데이터 세트는 종종 특이치를 가지며 이 시계열도 예외가 아니다.

이 시계열은 완전히 자동화된 방법으로 합리적인 예측을 생성하는 데 있어 어려움을 유용하게 설명한다. 그림 3은 Hyndman 등에 설명된 R의 예측 패키지에서 몇 가지 자동화된 절차를 사용한 예측을 보여준다. (2007). 역사의 세 지점에서 예측이 이루어졌으며, 각 지점은 해당 시점까지의 시계열 부분만을 사용하여 해당 날짜에 예측을 시뮬레이션했습니다. 그림의 방법은 다양한 ARIMA 모델에 적합하고 최적의 모델을 자동으로 선택하는 auto.arima, 지수 평활 모델 집합에 적합하고 최적의 모델을 선택하는 ets(Hyndman 등 2002), 주간 계절성(계절적 순진)으로 일정한 예측을 하는 랜덤 워크 모델인 스네이브, TBATS 모델인 TBATS 모델이다 주간 및 연간 계절(De Livera, Hyndman, Snyder 2011)과 함께.